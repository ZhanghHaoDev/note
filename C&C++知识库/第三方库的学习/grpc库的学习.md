# grpc库的学习

1. 什么是RPC

RPC即远程过程调用协议，可以让我们像调用本地对象一样发起远程调用。RPC凭借其强大的治理功能，成为解决分布式系统通信问题的一大利器

GRPC是一个现代的，高性能，开源的和语言无关的通用的RPC框架，基于HTTP2协议设计，序列化使用PB（protocal Buffer）,PB是一种语言无关的高性能序列化框架，基于HTTP2和PB保证了的高性能

![https://cdn.nlark.com/yuque/0/2024/png/23087967/1717319539096-0e361668-34de-4c8f-8cf1-2d18ed46e6bf.png](https://cdn.nlark.com/yuque/0/2024/png/23087967/1717319539096-0e361668-34de-4c8f-8cf1-2d18ed46e6bf.png)

---

1. GRPC的一些特性
2. GRPC基于服务的思想：定义一个服务，描述这个服务的方法以及入参出参，服务器端有这个服务的具体实现，客户端保有一个存根，提供与服务端相同的服务。
3. GRPC默认采用protocol buffer作为IDL（interface Description Lanage）接口描述语言，服务之间通信的数据序列化和反序列化也是基于protocol buffer的，因为protocol buffer的特殊性，所以grpc框架的跨语言的通信框架（与编程语言无关性）
4. grpc同时支持同步调用和异步调用，同步RPC调用时会一直阻塞直到服务端处理完成返回结果，异步RPC是客户端调用服务端时不等待服务端处理完成返回，而是服务端处理完成后主动回调客户端告诉客户端处理完成
5. grpc是基于HTTP2协议完成的，http2协议提供了很多新的特性，并且在性能上也比HTTP1提高了许多，所以GRPC的性能是非常好的
6. grpc允许定义如下面四类服务方法
7. 一元RPC：客户端发送一次请求，等待服务端响应结构，绘画结束，就像一次普通的函数调用这样简单（一个请求一个回答）
8. 服务端流式RPC：客户端发起一起请求，服务端会返回一个流，客户端会从流中读取一系列消息，直到没有结果为止（一个请求多个回答）
9. 客户端流式RPC：客户端提供一个数据流并写入消息发给服务端，一旦客户端发送完毕，就等待服务器读取这些消息并返回应答（多个请求一个回答）
10. 双向流式PRC：客户端和服务端都一个数据流，都可以通过各自的流进行读写数据，这两个流是相互独立的，客户端和服务端都可以按其希望的任意顺序读写（多个请求多个回答）
11. 数据封装和数据传输问题
12. 网络传输中的内容封装数据体积问题

早期的RPC采用JSON的方式，目前的RPC基本上都采用类似protobuf的二进制序列化方式

json相比protobuf效率低，占用字节也多

1. 网络传输效率问题

grpc采用HTTP2.0，相对于HTTP1.0在更快的传输和更低的成本两个目标上做了改进，有以下几个基本点

HTTP2.0未改变HTTP的语义（如GET/POST等），只是在传输上做了优化

引入帧，流的概念，在TCP连接中，可以区分出多个request/repose

一个域名只有一个TCP连接，借助帧，流可以实现多路复用，降低资源消耗

引入二进制编码，降低header带来的空间占用

1. RPC和GRPC介绍
2. RPC（Remote Procedure Call）远程过程调用协议，一种通过网络从远程计算机上请求服务，而不需要了解底层网络技术的协议，RPC他假定某些协议的存在，例如TCP/UDP等，为通信程序之间携带信息数据。
3. 在OSI网络七层模型中，RPC跨越了传输层和应用层，RPC使得开发，包括网络分布式多程序在内的应用程序更加容易
4. 过程是什么？过程就是业务，计算任务，更直白的说，就是程序，就是像调用本地方法一样调用远程的过程

RPC采用客户端/服务端的模式，通过request-response的消息模式

![https://cdn.nlark.com/yuque/0/2024/png/23087967/1717319538929-3bd70d3c-1e98-4089-b0f4-d9fd5b033a1d.png](https://cdn.nlark.com/yuque/0/2024/png/23087967/1717319538929-3bd70d3c-1e98-4089-b0f4-d9fd5b033a1d.png)

---

1. grpc里客户端应用可以像调用本地对象一样直接调用另一台不同的机器上服务端应用的方法，使得你能够更容易的创建分布式应用和服务。与许多RPC系统类似，grpc也是基于以下理念：定义一个服务，指定能够被远程调用的方法（包括参数和返回类型）。在服务端实现这个接口，并运行一个grpc服务来处理客户端调用，在客户端拥有一个存根能够像服务端应用的方法。

![https://cdn.nlark.com/yuque/0/2024/png/23087967/1717319538869-ce5a5fb1-a18e-4685-ae4d-79cf12283fa1.png](https://cdn.nlark.com/yuque/0/2024/png/23087967/1717319538869-ce5a5fb1-a18e-4685-ae4d-79cf12283fa1.png)

---

# 什么是远程过程调用

远程过程调用（Remote Procedure Call，RPC）是一种计算机通信协议，它允许调用另一台计算机上的程序，而不需要了解底层的通信细节。

在 RPC 中，客户端应用程序使用一个调用用户定义的函数的语句，而不需要知道这个函数的实现细节。这个函数实际上在远程服务器上执行，执行结果将返回给客户端应用程序。

RPC 可以在本地（同一台计算机上）或远程（在不同计算机上）上执行。远程执行需要网络协议的支持。

RPC 可以使用不同的数据序列化技术对执行结果进行编码和解码。常用的序列化技术包括 JSON 和 XML。

例子：当用户在使用网络应用程序填写表单时，这些表单数据被传输到远程 Web 服务器上处理。服务器上的应用程序通过 RPC 协议来调用本地应用程序来处理这些数据，最后返回结果给客户端的浏览器。

# 远程过程调用中的客户端和服务端

在远程过程调用 (RPC) 中，客户端和服务端是两个不同的角色。客户端程序通过网络向服务器程序发送请求，请求可以指定远程计算机上的一个特定的函数或子例程。服务端程序接收请求，执行特定的函数或子例程，并将结果返回给客户端。

客户端需要知道服务端的地址和远程函数的名称，以便能够发送正确的请求。服务端需要监听网络请求并处理它们，所有的函数必须以某种方式公开，以允许客户端通过网络调用它们。

以 C++ 为例，RPC 的实现通常需要使用特殊的工具，例如 Apache Thrift 或 Google Protocol Buffers。利用这些工具，可以方便地生成客户端和服务器之间的通信协议。

在客户端和服务端之间进行通信时，必须定制一种特定的协议，以便它们之间能够理解和解释彼此的数据。网络协议可以是基于 TCP 或 UDP 的，或者可以是其他专用的通信协议。

如果你想深入了解 RPC 的实现细节，可以参考 RPC 框架的源码。

[第一章 grpc的编译](第一章%20grpc的编译%2018dd4b146ea4463ca5f948689efe96d2.md)

[第二章 protobuf语法](第二章%20protobuf语法%207fe12d72361644418f590b857c3bbd54.md)

[第三章 常见的问题](第三章%20常见的问题%20bcf6f784ac83446b80f7093aa13ae847.md)