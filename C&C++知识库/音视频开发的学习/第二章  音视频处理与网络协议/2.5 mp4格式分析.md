# MP4格式分析


一个封装的 MP4 文件头部通常包含以下信息：

文件格式信息：

major_brand：主要品牌，表示文件的类型。
minor_version：次要版本号。
compatible_brands：兼容品牌列表。
文件元数据：

title：标题。
artist：艺术家。
album：专辑。
genre：流派。
year：年份。
comment：评论。
时长和比特率：

duration：文件的时长。
bitrate：文件的比特率。
流信息：

每个流的信息，包括视频流和音频流。
codec：编解码器类型（如 H.264、AAC）。
width 和 height：视频流的宽度和高度。
sample_rate：音频流的采样率。
channels：音频流的通道数。
其他信息：

handler_name：处理程序名称。
vendor_id：供应商 ID。


## 1. 引言
### 1.1 MP4格式简介
### 1.2 MP4格式的应用场景

## 2. MP4文件结构
### 2.1 盒（Box）结构概述
### 2.2 常见盒类型
#### 2.2.1 ftyp（文件类型盒）
#### 2.2.2 moov（电影盒）
##### 2.2.2.1 mvhd（电影头盒）
##### 2.2.2.2 trak（轨道盒）
###### 2.2.2.2.1 tkhd（轨道头盒）
###### 2.2.2.2.2 mdia（媒体盒）
####### 2.2.2.2.2.1 mdhd（媒体头盒）
####### 2.2.2.2.2.2 hdlr（处理器盒）
####### 2.2.2.2.2.3 minf（媒体信息盒）
######## 2.2.2.2.2.3.1 stbl（样本表盒）
######### 2.2.2.2.2.3.1.1 stsd（样本描述盒）
######### 2.2.2.2.2.3.1.2 stts（时间样本表）
######### 2.2.2.2.2.3.1.3 stsc（样本到块表）
######### 2.2.2.2.2.3.1.4 stsz（样本大小表）
######### 2.2.2.2.2.3.1.5 stco（块偏移表）
#### 2.2.3 mdat（媒体数据盒）

## 3. MP4文件解析步骤
### 3.1 读取文件头
### 3.2 解析ftyp盒
### 3.3 解析moov盒
### 3.4 解析trak盒
### 3.5 解析mdia盒
### 3.6 解析minf盒
### 3.7 解析stbl盒
### 3.8 读取mdat盒

## 4. 实例解析
### 4.1 使用FFmpeg解析MP4文件
### 4.2 示例代码

## 5. 总结
### 5.1 MP4格式的优点
### 5.2 MP4格式的局限性
### 5.3 未来发展方向